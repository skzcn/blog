<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>用户组管理</title>
    <link rel="stylesheet" href="/static/layui/css/layui.css">
</head>
<body style="padding: 20px; background-color: #fff;">
    <div class="layui-card">
        <div class="layui-card-header">
            用户组管理
            <button class="layui-btn layui-btn-sm" style="float: right; margin-top: 5px;" onclick="editGroup(0)">添加组</button>
        </div>
        <div class="layui-card-body">
            <table id="groupTable" lay-filter="groupTable"></table>
        </div>
    </div>

    <script type="text/html" id="bar">
        <a class="layui-btn layui-btn-xs" lay-event="edit">分配权限</a>
        <a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
    </script>

    <script src="/static/layui/layui.js"></script>
    <script>
        var table, layer;
        layui.use(['table', 'layer'], function(){
            table = layui.table;
            layer = layui.layer;
            var $ = layui.$;

            table.render({
                elem: '#groupTable',
                url: "{:url('auth/groups')}",
                cols: [[
                    {field: 'id', title: 'ID', width: 80},
                    {field: 'title', title: '组名称', width: 200},
                    {field: 'status', title: '状态', width: 100, templet: function(d){ return d.status == 1 ? '启用' : '禁用'; }},
                    {field: 'rules', title: '规则ID集'},
                    {fixed: 'right', title: '操作', toolbar: '#bar', width: 150}
                ]]
            });

            table.on('tool(groupTable)', function(obj){
                if(obj.event === 'edit'){
                    editGroup(obj.data.id);
                }
            });
        });

        function editGroup(id) {
            layer.open({
                type: 2,
                title: '编辑用户组权限',
                area: ['600px', '500px'],
                content: "{:url('auth/groupForm')}?id=" + id,
                end: function() { table.reload('groupTable'); }
            });
        }
    </script>
</body>
</html>
